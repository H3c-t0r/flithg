

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Flyte Launchplans &mdash; Flyte 0.0.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> Flyte
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Flyte Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../introduction/index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../index.html">User docs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../administrator/index.html">Administrator Docs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributor/index.html">Contributor Docs</a></li>
</ul>
<p class="caption"><span class="caption-text">Generated Documentation from Source</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/lyft/flyteidl">Flyte Language Specification</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Flyte</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
      <li>Flyte Launchplans</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/user/features/lanuchplans.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="flyte-launchplans">
<span id="fetaures-lanuchplans"></span><h1>Flyte Launchplans<a class="headerlink" href="#flyte-launchplans" title="Permalink to this headline">¶</a></h1>
<div class="section" id="when-to-use-launchplans">
<h2>When to use launchplans?<a class="headerlink" href="#when-to-use-launchplans" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>I want multiple schedules for my workflow with zero or more predefined inputs.</p></li>
<li><p>I want to run the same workflow but with a different set of notifications.</p></li>
<li><p>I want to share my workflow with another user with the inputs already set so that the other user can simply kick off an execution.</p></li>
<li><p>I want to share my workflow to another user but also make sure that some inputs can be overridden if needed.</p></li>
<li><p>I want to share my workflow with another user but make sure that some inputs are never changed.</p></li>
</ul>
</div>
<div class="section" id="partial-inputs-for-launchplans">
<h2>Partial Inputs for Launchplans<a class="headerlink" href="#partial-inputs-for-launchplans" title="Permalink to this headline">¶</a></h2>
<p>Launch plans bind a partial or complete list of inputs necessary to launch a workflow. Launch plan inputs must only assign inputs already defined in the reference workflow definition.  Refer to to <a class="reference internal" href="../concepts/launchplans_schedules.html#concepts-launchplans-inputs"><span class="std std-ref">primary launch plan concept documentation</span></a> for a detailed introduction to launch plan input types.</p>
<p>For example, let’s say you had the following workflow definition:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@workflow_class</span>
<span class="k">class</span> <span class="nc">MyWorkflow</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="n">sample_size</span> <span class="o">=</span> <span class="n">Input</span><span class="p">(</span><span class="n">Types</span><span class="o">.</span><span class="n">Integer</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">region</span> <span class="o">=</span> <span class="n">Input</span><span class="p">(</span><span class="n">Types</span><span class="o">.</span><span class="n">String</span><span class="p">)</span>
    <span class="n">run_date</span> <span class="o">=</span> <span class="n">Input</span><span class="p">(</span><span class="n">Types</span><span class="o">.</span><span class="n">Datetime</span><span class="p">)</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>If you wanted to run the workflow over a set of date ranges for a specific region, you could define the following launch plan:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sea_launch_plan</span> <span class="o">=</span> <span class="n">MyWorkflow</span><span class="o">.</span><span class="n">create_launch_plan</span><span class="p">(</span>
    <span class="n">default_inputs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;sample_size&#39;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">},</span>
    <span class="n">fixed_inputs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;region&#39;</span><span class="p">:</span> <span class="s1">&#39;SEA&#39;</span><span class="p">},</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Some things to note here, we redefine the <code class="docutils literal notranslate"><span class="pre">sample_size</span></code> input in the launch plan - this is perfectly fine. Workflow inputs with default values can be redefined in launch plans. If we decide at execution creation time to adjust <code class="docutils literal notranslate"><span class="pre">sample_size</span></code> once more that’s also perfectly fine because default_inputs can be overriden. However the region input is <em>fixed</em> and cannot be overriden.</p>
<p>The launch plan doesn’t assign run_date but there is nothing wrong with creating a launch plan that assigns all workflow inputs (either as default or fixed inputs). Of course all required inputs must be resolved at execution time, but execution creation requests can always accept dynamic inputs should your launch plan not define the complete set.</p>
<p>Let’s take a look at how to use the launch plan to create executions programmatically:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">timedelta</span><span class="p">,</span> <span class="n">date</span>

<span class="n">run_date</span> <span class="o">=</span> <span class="n">date</span><span class="p">(</span><span class="mi">2018</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">end_date</span> <span class="o">=</span> <span class="n">date</span><span class="p">(</span><span class="mi">2019</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">one_day</span> <span class="o">=</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="k">while</span> <span class="n">run_date</span> <span class="o">&lt;=</span> <span class="n">end_date</span><span class="p">:</span>
    <span class="n">sea_launch_plan</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;myflyteproject&#39;</span><span class="p">,</span> <span class="s1">&#39;myflytedomain&#39;</span><span class="p">,</span> <span class="n">inputs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;run_date&#39;</span><span class="p">:</span> <span class="n">run_date</span><span class="p">})</span>
    <span class="n">run_date</span> <span class="o">+=</span> <span class="n">one_day</span>
</pre></div>
</div>
<p>And boom, you’ve got a year’s worth of executions created!</p>
<p>Let’s say for 2019 data you’ve realized it makes sense to change the sample size. All your other data is in place and you can’t wait to be notified once this last workflow has completed. Easy! you can configure your launch plan like so:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">timedelta</span><span class="p">,</span> <span class="n">date</span>

<span class="n">improved_sea_launch_plan</span> <span class="o">=</span> <span class="n">MyWorkflow</span><span class="o">.</span><span class="n">create_launch_plan</span><span class="p">(</span>
   <span class="n">default_inputs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;sample_size&#39;</span><span class="p">:</span> <span class="mi">2000</span><span class="p">},</span>
   <span class="n">fixed_inputs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;region&#39;</span><span class="p">:</span> <span class="s1">&#39;SEA&#39;</span><span class="p">,</span> <span class="s1">&#39;run_date&#39;</span><span class="p">:</span> <span class="n">date</span><span class="p">(</span><span class="mi">2019</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)},</span>
   <span class="n">notifications</span><span class="o">=</span><span class="p">[</span><span class="n">notifications</span><span class="o">.</span><span class="n">Email</span><span class="p">([</span><span class="n">WorkflowExecutionPhase</span><span class="o">.</span><span class="n">SUCCEEDED</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;me@myemail.com&quot;</span><span class="p">])]</span>
<span class="p">)</span>
<span class="n">improved_sea_launch_plan</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;myflyteproject&#39;</span><span class="p">,</span> <span class="s1">&#39;myflytedomain&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;one_last_execution&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="schedules-for-launchplans">
<h2>Schedules for Launchplans<a class="headerlink" href="#schedules-for-launchplans" title="Permalink to this headline">¶</a></h2>
<p>Schedules can be expressed as <a class="reference internal" href="../concepts/launchplans_schedules.html#concepts-schedules"><span class="std std-ref">rate units or cron expressions</span></a>.</p>
<p>For example, considering the following workflow definition with a triggered-at time input:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@workflow_class</span>
<span class="k">class</span> <span class="nc">MyWorkflow</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="n">triggered_time</span> <span class="o">=</span> <span class="n">Input</span><span class="p">(</span><span class="n">Types</span><span class="o">.</span><span class="n">Datetime</span><span class="p">)</span>
    <span class="n">an_integer_input</span> <span class="o">=</span> <span class="n">Input</span><span class="p">(</span><span class="n">Types</span><span class="o">.</span><span class="n">Integer</span><span class="p">)</span>
    <span class="n">an_alternative_input</span> <span class="o">=</span> <span class="n">Input</span><span class="p">(</span><span class="n">Types</span><span class="o">.</span><span class="n">Integer</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>To run <code class="docutils literal notranslate"><span class="pre">MyScheduledWorkflow</span></code> every 5 minutes with a value set for <code class="docutils literal notranslate"><span class="pre">an_integer_input</span></code> and the scheduled execution time assigned to the <code class="docutils literal notranslate"><span class="pre">triggered_time</span></code> input you could define the following launch plan:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">my_schedule</span> <span class="o">=</span> <span class="n">schedule</span><span class="o">.</span><span class="n">FixedRate</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">minutes</span><span class="o">=</span><span class="mi">5</span><span class="p">),</span> <span class="n">kickoff_time_input_arg</span><span class="o">=</span><span class="s2">&quot;triggered_time&quot;</span><span class="p">)</span>
<span class="n">my_fixed_rate_launch_plan</span> <span class="o">=</span> <span class="n">MyWorkflow</span><span class="o">.</span><span class="n">create_launch_plan</span><span class="p">(</span>
    <span class="n">default_inputs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;an_integer_input&#39;</span><span class="p">:</span> <span class="n">Input</span><span class="p">(</span><span class="n">Types</span><span class="o">.</span><span class="n">Integer</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">900</span><span class="p">)},</span>
    <span class="n">schedule</span><span class="o">=</span><span class="n">my_schedule</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Workflows that run on a schedule do not always need a corresponding triggered at input value.
For example, take the following workflow:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@workflow_class</span>
<span class="k">class</span> <span class="nc">MyWorkflow</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="n">an_integer_input</span> <span class="o">=</span> <span class="n">Input</span><span class="p">(</span><span class="n">Types</span><span class="o">.</span><span class="n">Integer</span><span class="p">)</span>
    <span class="n">an_alternative_input</span> <span class="o">=</span> <span class="n">Input</span><span class="p">(</span><span class="n">Types</span><span class="o">.</span><span class="n">Integer</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>The above can be run on a cron schedule every 5 minutes like so:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">my_cron_launch_plan</span> <span class="o">=</span> <span class="n">MyWorkflow</span><span class="o">.</span><span class="n">create_launch_plan</span><span class="p">(</span>
    <span class="n">default_inputs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;an_integer_input&#39;</span><span class="p">:</span> <span class="n">Input</span><span class="p">(</span><span class="n">Types</span><span class="o">.</span><span class="n">Integer</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">5</span><span class="p">)},</span>
    <span class="n">schedule</span><span class="o">=</span><span class="n">schedules</span><span class="o">.</span><span class="n">CronSchedule</span><span class="p">(</span><span class="s1">&#39;0/5 * * * ? *&#39;</span><span class="p">),,</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Once you’ve initialized your launch plan, don’t forget to set it to active so that the schedule is run.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">my_fixed_rate_launch_plan</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">LaunchPlanState</span><span class="o">.</span><span class="n">ACTIVE</span><span class="p">)</span>
<span class="c1"># Our fixed rate schedule is now active.</span>

<span class="n">my_cron_launch_plan</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">LaunchPlanState</span><span class="o">.</span><span class="n">ACTIVE</span><span class="p">)</span>
<span class="c1"># Our cron schedule is now active too.</span>

<span class="c1"># Too many active, let&#39;s disable one!</span>
<span class="n">my_fixed_rate_launch_plan</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">LaunchPlanState</span><span class="o">.</span><span class="n">INACTIVE</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Flyte Authors

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>