

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Architecture &mdash; Flyte 0.0.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Installing Flyte" href="install/index.html" />
    <link rel="prev" title="Administrator Docs" href="index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> Flyte
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Flyte Documentation</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction/index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/index.html">User docs</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Administrator Docs</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Architecture</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#flyteidl">FlyteIDL</a></li>
<li class="toctree-l3"><a class="reference internal" href="#planes">Planes ✈️</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#user-plane">User Plane</a></li>
<li class="toctree-l4"><a class="reference internal" href="#control-plane">Control Plane</a></li>
<li class="toctree-l4"><a class="reference internal" href="#data-plane">Data Plane</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="install/index.html">Installing Flyte</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../contributor/index.html">Contributor Docs</a></li>
</ul>
<p class="caption"><span class="caption-text">Generated Documentation from Source</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/lyft/flyteidl">Flyte Language Specification</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Flyte</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Administrator Docs</a> &raquo;</li>
        
      <li>Architecture</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/administrator/architecture.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="architecture">
<span id="architecture-overview"></span><h1>Architecture<a class="headerlink" href="#architecture" title="Permalink to this headline">¶</a></h1>
<p>This document aims to demystify how Flyte’s major components <code class="docutils literal notranslate"><span class="pre">FlyteIDL</span></code>, <code class="docutils literal notranslate"><span class="pre">FlyteKit</span></code>, <code class="docutils literal notranslate"><span class="pre">FlyteCLI</span></code>, <code class="docutils literal notranslate"><span class="pre">FlyteConsole</span></code>, <code class="docutils literal notranslate"><span class="pre">FlyteAdmin</span></code>, <code class="docutils literal notranslate"><span class="pre">FlytePropeller</span></code>, and <code class="docutils literal notranslate"><span class="pre">FlytePlugins</span></code> fit together at a high level.</p>
<div class="section" id="flyteidl">
<h2>FlyteIDL<a class="headerlink" href="#flyteidl" title="Permalink to this headline">¶</a></h2>
<p>In Flyte, entities like “Workflows”, “Tasks”, “Launch Plans”, and “Schedules” are recognized by multiple system components. In order for components to communicate effectively, they need a shared understanding about the structure of these entities.</p>
<p>The Flyte IDL (Interface Definition Language) is where shared Flyte entities are defined. This IDL also defines the RPC service definition for the <a class="reference external" href="https://github.com/lyft/flyteidl/blob/master/protos/flyteidl/service/admin.proto">core Flyte API</a>.</p>
<p>FlyteIDL uses the <a class="reference external" href="https://developers.google.com/protocol-buffers/">protobuf</a> schema to describe entities. Clients are generated for Python, Golang, and JavaScript and imported by Flyte components.</p>
</div>
<div class="section" id="planes">
<h2>Planes ✈️<a class="headerlink" href="#planes" title="Permalink to this headline">¶</a></h2>
<p>Flyte components are separated into 3 logical planes. The planes are summarized here and explained in further detail below. The goal is that any of these planes can be replaced by an alternate implementation.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 15%" />
<col style="width: 85%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>User Plane</strong></p></td>
<td><p>The User Plane consists of all user tools that assist in interacting with the core Flyte API.
These tools include the FlyteConsole, FlyteKit, and FlyteCLI.</p></td>
</tr>
<tr class="row-even"><td><p><strong>Control Plane</strong></p></td>
<td><p>The Control Plane implements the core Flyte API.
It serves all client requests coming from the User Plane.
It stores information such as current and past running workflows, and provides that information upon request.
It also accepts requests to execute workflows, but offloads the work to the Data Plane.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Data Plane</strong></p></td>
<td><p>The sole responsibility of the the Data Plane is to fulfill workflows.
It accepts workflow requests from the Control Plane and guides the workflow to completion,
launching tasks on a cluster of machines as necessary based on the workflow graph.
It sends status events back to the control plane so the information can be stored and surfaced to end-users.</p></td>
</tr>
</tbody>
</table>
<div class="section" id="user-plane">
<h3>User Plane<a class="headerlink" href="#user-plane" title="Permalink to this headline">¶</a></h3>
<p>In Flyte, workflows are represented as a Directed Acyclic Graph (DAG) of tasks. While this representation is logical for services, managing workflow DAGs in this format is a tedious exercise for humans. The Flyte User Plane provides tools to create, manage, and visualize workflows in a format that is easily digestible to users.</p>
<p>These tools include:</p>
<dl class="simple">
<dt>FlyteKit</dt><dd><p>FlyteKit is an SDK that helps users design new workflows using the Python programming language. FlyteKit can parse the python code, compile it into a valid Workflow DAG, and submit it to Flyte to be executed.</p>
</dd>
<dt>FlyteConsole</dt><dd><p>Flyte console provides the Web interface for Flyte. Users and administrators can use the console to view workflows, launch plans, schedules, tasks, and individual task executions. The console provides tools to visualize workflows, and surfaces relevant logs for debugging failed tasks.</p>
</dd>
<dt>FlyteCLI</dt><dd><p>Flyte Command Line Interface provides interactive access to Flyte to launch and access Flyte workflows via terminal.</p>
</dd>
</dl>
</div>
<div class="section" id="control-plane">
<h3>Control Plane<a class="headerlink" href="#control-plane" title="Permalink to this headline">¶</a></h3>
<p>The Control Plane supports the core REST/gRPC API defined in FlyteIDL. User Plane tools like FlyteConsole and FlyteKit contact the control plane on behalf of users to store and retrieve information.</p>
<p>Currently, the entire control plane is handled by a single service called <strong>FlyteAdmin</strong>.</p>
<p>FlyteAdmin is stateless. It processes requests to create entities like Tasks, Workflows, and Schedules by persisting data in a relational database.</p>
<p>While FlyteAdmin serves the Workflow Exeuction API, it does not, itself, execute workflows. To launch workflow executions, FlyteAdmin sends the workflow DAG off to the DataPlane. For added scalability and fault-tolerance, FlyteAdmin can be configured to load-balance workflows across multiple isolated data-plane clusters.</p>
</div>
<div class="section" id="data-plane">
<h3>Data Plane<a class="headerlink" href="#data-plane" title="Permalink to this headline">¶</a></h3>
<p>The Data Plane is the engine that accepts DAGs, and fulfills workflow executions by launching tasks in the order defined by the graph. Requests to the Data Plane generally come via the control plane, and not from end-users.</p>
<p>In order to support compute-intensive workflows at massive scale, the Data Plane needs to launch containers on a cluster of machines. The current implementation leverages <a class="reference external" href="https://kubernetes.io/">kubernetes</a> for cluster management.</p>
<p>Unlike the user-facing control-plane, the Data Plane does not expose a traditional REST/gRPC API. To launch an execution in the Data Plane, you create a “flyteworkflow” resource in kubernetes.
A “flyteworkflow” is a kubernetes <a class="reference external" href="https://kubernetes.io/docs/concepts/extend-kubernetes/api-extension/custom-resources/">Custom Resource</a> (CRD) created by our team. This custom resource represents the flyte workflow DAG.</p>
<p>The core state machine that processes flyteworkflows is worker we call <strong>FlytePropeller</strong>.</p>
<p>FlytePropeller leverages the kubernetes <a class="reference external" href="https://kubernetes.io/docs/concepts/extend-kubernetes/operator/">operator pattern</a>. It polls the kubernetes API, looking for newly created flyteworkflow resources. FlytePropeller understands the workflow DAG, and launches the appropriate kubernetes pods as needed to complete tasks. It periodically checks for completed tasks, launching downstream tasks until the workflow is complete.</p>
<p><strong>Plugins</strong></p>
<p>Each task in a flyteworkflow DAG has a specified <strong>type</strong>. The logic for fulfilling a task is determined by its task type.
In the most basic case, FlytePropeller launches a single kubernetes pod to fulfill a task.
More complex task types require workloads to be distributed across hundreds of pods.</p>
<p>The type-specific task logic is separated into isolated code modules that we call <strong>plugins</strong>.
Each task type has an associated plugin that is responsible for handling tasks of its type.
For each task in a workflow, FlytePropeller activates the appropriate plugin based on the task type in order to fullfill the task.</p>
<p>The Flyte team has pre-built plugins for Hive, Spark, and AWS Batch, and more.
To support new use-cases, developers can create their own plugins and bundle them in their FlytePropeller deployment.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="install/index.html" class="btn btn-neutral float-right" title="Installing Flyte" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral float-left" title="Administrator Docs" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Flyte Authors

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>